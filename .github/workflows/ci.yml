name: CI

on:
  push:
    branches:
      - main
      - eedorenko/*
  workflow_dispatch:

permissions:
  contents: read

jobs:
  code-quality-validation:
    name: Code Quality Validation
    uses: ./.github/workflows/code-quality.yml
    permissions:
      contents: read

  codeql:
    name: CodeQL Security Analysis
    uses: ./.github/workflows/codeql-analysis.yml
    permissions:
      contents: read
      security-events: write
      actions: read

  extension-package:
    needs: [code-quality-validation, codeql]
    name: Package VS Code Extension
    uses: ./.github/workflows/extension-package.yml
    with:
      dev-patch-number: ${{ github.run_number }}
    permissions:
      contents: read
